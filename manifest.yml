app:
  runtime:
    name: nodejs20.x
  id: ari:cloud:ecosystem::app/9a48dab4-314a-4dff-8651-24081741913d

permissions:
  scopes:
    - read:pullrequest:bitbucket
    - read:repository:bitbucket
    - write:pullrequest:bitbucket
    - storage:app
  external:
    fetch:
      backend:
        - address: generativelanguage.googleapis.com
        - address: nztdwsnmttwwjticuphi.supabase.co

modules:
  function:
    - key: getRiskAnalysis
      handler: bridge/getRiskAnalysis.handler
    - key: postPRComment
      handler: bridge/postPRComment.handler
    - key: getSimilarIncidents
      handler: bridge/getSimilarIncidents.handler
    - key: improvePRQuality
      handler: rovo/prQualityAgent.handler
    - key: loadSeedData
      handler: bridge/loadSeedData.loadSeedDataHandler
    # Feature 1: AI-Powered Remediation
    - key: getAIRemediation
      handler: bridge/getRiskAnalysis.handler
    # Feature 2: Team Health Dashboard
    - key: getTeamDashboard
      handler: bridge/getTeamDashboard.handler

  bitbucket:repoPullRequestCard:
    - key: pr-risk-panel
      resource: main
      resolver:
        function: getRiskAnalysis
      title: Code Risk Analysis

resources:
  - key: main
    path: frontend/dist
